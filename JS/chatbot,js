fetch('/src/bot.html')
    .then(response => {
        if (!response.ok) throw new Error("Failed to load bot.html");
        return response.text();
    })
    .then(data => {
        const container = document.getElementById('chat-widget-container');
        if (!container) {
            console.warn("Chat widget container not found in DOM.");
            return;
        }
        container.innerHTML = data;

        // Re-execute scripts extracted from the HTML fragment
        const scripts = container.querySelectorAll('script');
        scripts.forEach(oldScript => {
            const newScript = document.createElement('script');
            if (oldScript.src) {
                newScript.src = oldScript.src;
                newScript.onload = () => {
                    if (typeof initializeChatBot === 'function') {
                        initializeChatBot();
                    }
                };
            } else {
                newScript.textContent = oldScript.textContent;
            }
            document.body.appendChild(newScript);
        });
        
        // Initialize if script was inline and ready
        if (typeof initializeChatBot === 'function') {
            initializeChatBot();
        }
    })
    .catch(error => console.error('Error loading chatbot:', error));