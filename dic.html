<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lexicon - Dictionary & Thesaurus</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:ital,wght@0,400;0,700;1,400&family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        'serif': ['Merriweather', 'serif'],
                        'sans': ['Plus Jakarta Sans', 'sans-serif'],
                    },
                    colors: {
                        brand: {
                            50: '#eff6ff',
                            100: '#dbeafe',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body { transition: background-color 0.3s, color 0.3s; }
        .glass-card {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        .dark .glass-card {
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        .skeleton {
            background: linear-gradient(90deg, #f3f4f6 25%, #e5e7eb 50%, #f3f4f6 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite linear;
        }
        .dark .skeleton {
            background: linear-gradient(90deg, #1e293b 25%, #334155 50%, #1e293b 75%);
            background-size: 200% 100%;
        }

        .tab-active { @apply text-brand-600 border-brand-600 dark:text-brand-400 dark:border-brand-400; }
        .tab-inactive { @apply text-slate-400 border-transparent hover:text-slate-600 dark:hover:text-slate-200; }
    </style>
</head>
<body class="bg-gray-50 dark:bg-slate-950 font-sans text-slate-900 dark:text-slate-100 min-h-screen">

    <!-- Header / Navigation -->
    <nav class="sticky top-0 z-40 glass-card border-b px-4 py-3 flex justify-between items-center">
        <div class="flex items-center gap-2 cursor-pointer" onclick="window.location.reload()">
            <div class="bg-brand-600 p-2 rounded-lg">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" /></svg>
            </div>
            <span class="text-xl font-bold tracking-tight">Lexicon</span>
        </div>
        
        <div class="flex items-center gap-2">
            <button onclick="getRandomWord()" class="p-2 hover:bg-slate-200 dark:hover:bg-slate-800 rounded-full transition-colors" title="Random Word">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" /></svg>
            </button>
            <button onclick="toggleDarkMode()" class="p-2 hover:bg-slate-200 dark:hover:bg-slate-800 rounded-full transition-colors" title="Toggle Theme">
                <svg id="theme-icon-dark" class="hidden w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4-9H3m15.364-6.364l-.707.707M6.343 17.657l-.707.707M16.243 17.657l.707.707M6.343 6.343l.707-.707m12.728 0l-.707.707M12 8a4 4 0 100 8 4 4 0 000-8z" /></svg>
                <svg id="theme-icon-light" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" /></svg>
            </button>
            <button onclick="toggleDrawer()" class="p-2 hover:bg-slate-200 dark:hover:bg-slate-800 rounded-full transition-colors" title="History & Favorites">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" /></svg>
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="max-w-4xl mx-auto px-4 py-8 pb-24">
        
        <!-- Search Area -->
        <div class="relative group mb-6">
            <div class="absolute inset-y-0 left-0 pl-5 flex items-center pointer-events-none text-slate-400 group-focus-within:text-brand-500 transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
            </div>
            <input type="text" id="searchInput" placeholder="Search any word..." 
                class="w-full py-5 pl-12 pr-28 rounded-2xl border-none ring-1 ring-slate-200 dark:ring-slate-800 bg-white dark:bg-slate-900 focus:ring-2 focus:ring-brand-500 shadow-xl shadow-slate-200/50 dark:shadow-none outline-none transition-all text-xl"
                onkeydown="if(event.key === 'Enter') searchWord()">
            <button onclick="searchWord()" 
                class="absolute right-2 top-2 bottom-2 bg-brand-600 hover:bg-brand-700 text-white font-medium px-8 rounded-xl transition-all active:scale-95">
                Search
            </button>
        </div>

        <!-- Mode Toggle Tabs -->
        <div class="flex gap-8 border-b dark:border-slate-800 mb-8 px-2">
            <button id="tab-dictionary" onclick="switchMode('dictionary')" class="pb-3 border-b-2 font-semibold text-sm uppercase tracking-wider transition-all tab-active">
                Dictionary
            </button>
            <button id="tab-thesaurus" onclick="switchMode('thesaurus')" class="pb-3 border-b-2 font-semibold text-sm uppercase tracking-wider transition-all tab-inactive">
                Thesaurus
            </button>
        </div>

        <!-- Skeleton Loader -->
        <div id="skeleton" class="hidden space-y-6">
            <div class="flex justify-between items-start">
                <div class="space-y-3 w-1/2">
                    <div class="h-10 w-full skeleton rounded-lg"></div>
                    <div class="h-6 w-2/3 skeleton rounded-lg"></div>
                </div>
                <div class="w-14 h-14 skeleton rounded-full"></div>
            </div>
            <div class="h-px bg-slate-200 dark:bg-slate-800"></div>
            <div class="space-y-4">
                <div class="h-6 w-24 skeleton rounded-md"></div>
                <div class="h-20 w-full skeleton rounded-lg"></div>
                <div class="h-20 w-full skeleton rounded-lg"></div>
            </div>
        </div>

        <!-- Error State -->
        <div id="error-msg" class="hidden animate-in fade-in duration-300">
            <div class="p-10 text-center glass-card rounded-2xl border border-red-100 dark:border-red-900/30">
                <div class="w-16 h-16 bg-red-50 dark:bg-red-900/20 text-red-500 rounded-full flex items-center justify-center mx-auto mb-4">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                </div>
                <h3 class="text-xl font-bold mb-1">Word not found</h3>
                <p class="text-slate-500 dark:text-slate-400">We couldn't find details for the word you're looking for.</p>
            </div>
        </div>

        <!-- Result Content -->
        <div id="result-container" class="hidden space-y-8 animate-in slide-in-from-bottom-4 duration-500">
            
            <div class="flex flex-col md:flex-row justify-between items-start gap-6">
                <div class="flex-1">
                    <div class="flex items-center gap-4 mb-2">
                        <h1 id="word" class="text-6xl font-serif font-bold text-slate-900 dark:text-white capitalize tracking-tight"></h1>
                        <button id="fav-btn" onclick="toggleFavorite()" class="mt-2 text-slate-300 hover:text-brand-500 transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="currentColor" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
                        </button>
                    </div>
                    
                    <!-- Multi-Phonetic Container (Only in Dictionary) -->
                    <div id="phonetic-container" class="flex flex-wrap gap-4 items-center"></div>
                </div>
            </div>

            <!-- Dynamic Section (Dictionary OR Thesaurus View) -->
            <div id="view-content" class="space-y-12"></div>

            <!-- Footer Meta -->
            <div class="mt-12 pt-8 border-t border-slate-200 dark:border-slate-800 space-y-4">
                <div id="source-links" class="flex flex-wrap gap-x-6 gap-y-2 text-sm">
                    <span class="text-slate-400 font-bold uppercase tracking-widest">Sources:</span>
                </div>
            </div>
        </div>
    </main>

    <!-- Sidebar Drawer -->
    <div id="drawer-overlay" onclick="toggleDrawer()" class="fixed inset-0 bg-slate-900/40 backdrop-blur-sm z-50 hidden opacity-0 transition-opacity duration-300"></div>
    <div id="drawer" class="fixed top-0 right-0 h-full w-80 bg-white dark:bg-slate-900 z-[60] shadow-2xl transform translate-x-full transition-transform duration-300 flex flex-col">
        <div class="p-6 border-b dark:border-slate-800 flex justify-between items-center">
            <h2 class="text-xl font-bold">Lexicon Vault</h2>
            <button onclick="toggleDrawer()" class="p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
            </button>
        </div>
        <div class="flex-1 overflow-y-auto no-scrollbar p-6 space-y-8">
            <div>
                <h3 class="text-xs font-bold uppercase tracking-wider text-slate-400 mb-4 flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-red-500" fill="currentColor" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
                    Saved Words
                </h3>
                <div id="fav-list" class="space-y-2"></div>
            </div>
            <div>
                <h3 class="text-xs font-bold uppercase tracking-wider text-slate-400 mb-4 flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                    Recent History
                </h3>
                <div id="history-list" class="space-y-2"></div>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="fixed bottom-6 left-1/2 -translate-x-1/2 glass-card border-none bg-brand-600 text-white px-6 py-3 rounded-full shadow-2xl transition-all translate-y-20 opacity-0 pointer-events-none">
        Copied to clipboard
    </div>

    <script>
        const apiURL = "https://api.dictionaryapi.dev/api/v2/entries/en/";
        let currentWordData = null;
        let activeMode = 'dictionary'; // 'dictionary' or 'thesaurus'
        let history = JSON.parse(localStorage.getItem('lexicon_history') || '[]');
        let favorites = JSON.parse(localStorage.getItem('lexicon_favorites') || '[]');

        // Initialize Theme
        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
            document.getElementById('theme-icon-dark').classList.remove('hidden');
            document.getElementById('theme-icon-light').classList.add('hidden');
        }

        function toggleDarkMode() {
            const isDark = document.documentElement.classList.toggle('dark');
            localStorage.theme = isDark ? 'dark' : 'light';
            document.getElementById('theme-icon-dark').classList.toggle('hidden');
            document.getElementById('theme-icon-light').classList.toggle('hidden');
        }

        function switchMode(mode) {
            activeMode = mode;
            document.getElementById('tab-dictionary').className = `pb-3 border-b-2 font-semibold text-sm uppercase tracking-wider transition-all ${mode === 'dictionary' ? 'tab-active' : 'tab-inactive'}`;
            document.getElementById('tab-thesaurus').className = `pb-3 border-b-2 font-semibold text-sm uppercase tracking-wider transition-all ${mode === 'thesaurus' ? 'tab-active' : 'tab-inactive'}`;
            
            if (currentWordData) renderContent();
        }

        function toggleDrawer() {
            const drawer = document.getElementById('drawer');
            const overlay = document.getElementById('drawer-overlay');
            const isOpen = !drawer.classList.contains('translate-x-full');

            if (isOpen) {
                drawer.classList.add('translate-x-full');
                overlay.classList.add('opacity-0');
                setTimeout(() => overlay.classList.add('hidden'), 300);
            } else {
                renderDrawerLists();
                overlay.classList.remove('hidden');
                setTimeout(() => {
                    overlay.classList.remove('opacity-0');
                    drawer.classList.remove('translate-x-full');
                }, 10);
            }
        }

        async function searchWord(wordToSearch) {
            const input = document.getElementById('searchInput');
            const query = (wordToSearch || input.value).trim().toLowerCase();
            const resultContainer = document.getElementById('result-container');
            const errorMsg = document.getElementById('error-msg');
            const skeleton = document.getElementById('skeleton');

            if (!query) return;
            if (wordToSearch) input.value = wordToSearch;

            resultContainer.classList.add('hidden');
            errorMsg.classList.add('hidden');
            skeleton.classList.remove('hidden');

            try {
                const response = await fetch(apiURL + query);
                if (!response.ok) throw new Error("Not found");
                
                const data = await response.json();
                currentWordData = data[0];
                addToHistory(query);
                renderContent();
            } catch (error) {
                skeleton.classList.add('hidden');
                errorMsg.classList.remove('hidden');
            }
        }

        function renderContent() {
            const skeleton = document.getElementById('skeleton');
            const container = document.getElementById('result-container');
            const wordEl = document.getElementById('word');
            const phoneticContainer = document.getElementById('phonetic-container');
            const favBtn = document.getElementById('fav-btn');
            const viewContent = document.getElementById('view-content');

            wordEl.textContent = currentWordData.word;
            favBtn.classList.toggle('text-red-500', favorites.includes(currentWordData.word.toLowerCase()));
            favBtn.classList.toggle('text-slate-300', !favorites.includes(currentWordData.word.toLowerCase()));

            // Render Mode Specific UI
            if (activeMode === 'dictionary') {
                renderDictionaryView();
                phoneticContainer.classList.remove('hidden');
            } else {
                renderThesaurusView();
                phoneticContainer.classList.add('hidden');
            }

            // Universal Metadata (Sources)
            const sourceContainer = document.getElementById('source-links');
            sourceContainer.innerHTML = `<span class="text-slate-400 font-bold uppercase tracking-widest">Sources:</span>`;
            (currentWordData.sourceUrls || []).forEach(url => {
                const a = document.createElement('a');
                a.href = url;
                a.target = "_blank";
                a.className = "text-brand-500 hover:underline flex items-center gap-1";
                a.innerHTML = `Wiktionary <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" viewBox="0 0 20 20" fill="currentColor"><path d="M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z" /><path d="M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z" /></svg>`;
                sourceContainer.appendChild(a);
            });

            skeleton.classList.add('hidden');
            container.classList.remove('hidden');
        }

        function renderDictionaryView() {
            const viewContent = document.getElementById('view-content');
            const phoneticList = document.getElementById('phonetic-container');
            
            phoneticList.innerHTML = "";
            const activePhonetics = currentWordData.phonetics.filter(p => p.text || p.audio);
            activePhonetics.forEach(p => {
                const chip = document.createElement('div');
                chip.className = "flex items-center gap-2 bg-brand-50 dark:bg-brand-900/20 px-4 py-2 rounded-xl border border-brand-100 dark:border-brand-800/50";
                chip.innerHTML = `<span class="text-lg text-brand-600 dark:text-brand-400 font-mono">${p.text || ""}</span>`;
                if (p.audio) {
                    const btn = document.createElement('button');
                    btn.className = "p-1.5 rounded-lg bg-brand-600 text-white hover:bg-brand-700 transition-all transform hover:scale-105";
                    btn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" /></svg>`;
                    btn.onclick = () => new Audio(p.audio).play();
                    chip.appendChild(btn);
                }
                phoneticList.appendChild(chip);
            });

            viewContent.innerHTML = currentWordData.meanings.map(m => `
                <div class="relative">
                    <div class="flex items-center gap-4 mb-8">
                        <span class="text-2xl font-bold italic text-slate-900 dark:text-slate-100 pr-4 bg-gray-50 dark:bg-slate-950 z-10">${m.partOfSpeech}</span>
                        <div class="h-px bg-slate-200 dark:bg-slate-800 w-full"></div>
                    </div>
                    <ul class="space-y-8">
                        ${m.definitions.map(d => `
                            <li>
                                <div class="flex gap-6">
                                    <div class="w-2 h-2 rounded-full bg-brand-500 mt-2.5 flex-shrink-0"></div>
                                    <div class="flex-1">
                                        <p class="text-xl text-slate-800 dark:text-slate-200 leading-relaxed">${d.definition}</p>
                                        ${d.example ? `<p class="mt-4 text-slate-500 italic text-lg border-l-4 border-slate-100 dark:border-slate-800 pl-6">"${d.example}"</p>` : ''}
                                    </div>
                                </div>
                            </li>
                        `).join('')}
                    </ul>
                </div>
            `).join('');
        }

        function renderThesaurusView() {
            const viewContent = document.getElementById('view-content');
            
            viewContent.innerHTML = `
                <div class="p-6 rounded-3xl bg-brand-600 text-white shadow-2xl shadow-brand-500/20 mb-10">
                    <h3 class="text-brand-100 uppercase tracking-widest font-bold text-xs mb-2">Word Context</h3>
                    <p class="text-xl font-medium leading-relaxed">${currentWordData.meanings[0]?.definitions[0]?.definition || "Context not available"}</p>
                </div>
            `;

            currentWordData.meanings.forEach(m => {
                const totalSynonyms = [...m.synonyms, ...m.definitions.flatMap(d => d.synonyms || [])];
                const totalAntonyms = [...m.antonyms, ...m.definitions.flatMap(d => d.antonyms || [])];

                if (totalSynonyms.length === 0 && totalAntonyms.length === 0) return;

                const section = document.createElement('div');
                section.className = "p-8 rounded-3xl bg-white dark:bg-slate-900/50 border border-slate-100 dark:border-slate-800 space-y-8 shadow-sm";
                section.innerHTML = `
                    <div class="flex items-center justify-between border-b dark:border-slate-800 pb-4">
                        <span class="text-xl font-bold capitalize">${m.partOfSpeech}</span>
                        <span class="text-slate-400 text-sm font-medium">${totalSynonyms.length} Alternatives</span>
                    </div>
                    
                    ${totalSynonyms.length > 0 ? `
                        <div>
                            <h4 class="text-xs font-bold uppercase tracking-widest text-slate-400 mb-4">Synonyms & Related</h4>
                            <div class="flex flex-wrap gap-2">
                                ${Array.from(new Set(totalSynonyms)).map(s => `
                                    <button onclick="searchWord('${s}')" class="px-5 py-2.5 rounded-2xl bg-brand-50 dark:bg-brand-900/20 text-brand-700 dark:text-brand-400 font-semibold hover:bg-brand-600 hover:text-white transition-all transform active:scale-95 shadow-sm border border-brand-100 dark:border-brand-800/50">
                                        ${s}
                                    </button>
                                `).join('')}
                            </div>
                        </div>
                    ` : ''}

                    ${totalAntonyms.length > 0 ? `
                        <div>
                            <h4 class="text-xs font-bold uppercase tracking-widest text-rose-400/70 mb-4">Antonyms (Opposites)</h4>
                            <div class="flex flex-wrap gap-2">
                                ${Array.from(new Set(totalAntonyms)).map(a => `
                                    <button onclick="searchWord('${a}')" class="px-5 py-2.5 rounded-2xl bg-rose-50 dark:bg-rose-900/20 text-rose-600 dark:text-rose-400 font-semibold hover:bg-rose-600 hover:text-white transition-all transform active:scale-95 shadow-sm border border-rose-100 dark:border-rose-800/50">
                                        ${a}
                                    </button>
                                `).join('')}
                            </div>
                        </div>
                    ` : ''}
                `;
                viewContent.appendChild(section);
            });

            // If no thesaurus data found
            if (viewContent.children.length <= 1) {
                viewContent.innerHTML += `
                    <div class="text-center py-20 opacity-50">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 mx-auto mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                        <p class="text-xl font-medium">No specialized thesaurus entries for this word.</p>
                        <p class="text-sm">Try searching for a base word or a common adjective.</p>
                    </div>
                `;
            }
        }

        // Feature Logic
        function addToHistory(word) {
            history = history.filter(w => w !== word);
            history.unshift(word);
            history = history.slice(0, 10);
            localStorage.setItem('lexicon_history', JSON.stringify(history));
            renderDrawerLists();
        }

        function toggleFavorite() {
            if (!currentWordData) return;
            const word = currentWordData.word.toLowerCase();
            const index = favorites.indexOf(word);
            const btn = document.getElementById('fav-btn');

            if (index > -1) {
                favorites.splice(index, 1);
                btn.classList.replace('text-red-500', 'text-slate-300');
            } else {
                favorites.unshift(word);
                btn.classList.replace('text-slate-300', 'text-red-500');
            }
            localStorage.setItem('lexicon_favorites', JSON.stringify(favorites));
            renderDrawerLists();
        }

        function renderDrawerLists() {
            const histList = document.getElementById('history-list');
            const favList = document.getElementById('fav-list');

            histList.innerHTML = history.length ? history.map(w => `
                <button onclick="searchWord('${w}'); toggleDrawer();" class="w-full text-left px-4 py-3 rounded-2xl hover:bg-slate-100 dark:hover:bg-slate-800 transition-all flex justify-between items-center group">
                    <span class="capitalize font-medium">${w}</span>
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 opacity-0 group-hover:opacity-100 transition-opacity" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3" /></svg>
                </button>
            `).join('') : '<p class="text-slate-500 text-sm italic px-4">Nothing searched yet.</p>';

            favList.innerHTML = favorites.length ? favorites.map(w => `
                <div class="flex items-center gap-1 group">
                    <button onclick="searchWord('${w}'); toggleDrawer();" class="flex-1 text-left px-4 py-3 rounded-2xl hover:bg-slate-100 dark:hover:bg-slate-800 transition-all capitalize font-medium">
                        ${w}
                    </button>
                    <button onclick="removeFavorite('${w}')" class="p-2 text-slate-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-all">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg>
                    </button>
                </div>
            `).join('') : '<p class="text-slate-500 text-sm italic px-4">No words saved.</p>';
        }

        function removeFavorite(word) {
            favorites = favorites.filter(w => w !== word);
            localStorage.setItem('lexicon_favorites', JSON.stringify(favorites));
            if (currentWordData && currentWordData.word.toLowerCase() === word) {
                document.getElementById('fav-btn').classList.replace('text-red-500', 'text-slate-300');
            }
            renderDrawerLists();
        }

        async function getRandomWord() {
            const words = ["eloquence", "nefarious", "magnanimous", "fastidious", "ephemeral", "petrichor", "ethereal", "melancholy", "sonorous", "solitude", "vibrant", "wanderlust", "nexus", "ubiquitous", "liminal", "quintessential"];
            searchWord(words[Math.floor(Math.random() * words.length)]);
        }

        window.onload = () => {
            const urlParams = new URLSearchParams(window.location.search);
            const wordParam = urlParams.get('w');
            if (wordParam) searchWord(wordParam);
            else getRandomWord();
        }
    </script>
</body>
</html>