<!DOCTYPE html>
<html lang="en-US" class="scroll-smooth">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description"
        content="Hesten's Learning - Empowering students with learning disabilities through personalized learning experiences." />
    <meta name="keywords"
        content="learning disabilities, personalized education, online learning, math, ELA, science, social studies" />
    <title>Hesten's Learning - New Overhaul</title>
    <!-- Favicon Placeholder -->
    <link rel="icon" href="/Images/large.ico"
        onerror="this.onerror=null; this.href='https://placehold.co/32x32/4F46E5/FFFFFF?text=HL';">

    <!-- Font Awesome for Icons - Kept as it is an external icon set -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />

    <!-- === FONT IMPORTS (For Accessibility Panel) === -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap"
        rel="stylesheet" />
    <!-- Fix: Preload path uses 'font/OpenDydlexic' which looks like a typo. Assuming correct path/typo fix for font loading. -->
    <link rel="preload" href="font/OpenDyslexic/OpenDyslexic-Regular.otf" as="font" type="font/otf" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&display=swap" rel="stylesheet" />

    <!-- Inline JavaScript for Global Accessibility/Theme State Management -->
    <script>
        // --- Global Accessibility/Theme State Management ---
        const defaultSettings = {
            theme: 'dark',
            fontSize: 1.0,
            lineHeight: 1.6,
            fontFamily: 'Inter',
            reducedMotion: window.matchMedia('(prefers-reduced-motion: reduce)').matches,
            letterSpacing: 0,
            wordSpacing: 0,
            highlightLinks: false,
            readableWidth: false,
        };
        const STORAGE_KEY = 'hl_accessibility_settings';

        function loadSettings() {
            try {
                const stored = localStorage.getItem(STORAGE_KEY);
                const loadedSettings = stored ? { ...defaultSettings, ...JSON.parse(stored) } : defaultSettings;
                // Migration logic for old 'dyslexiaFont' boolean (kept for robustness)
                if (loadedSettings.dyslexiaFont !== undefined) {
                    loadedSettings.fontFamily = loadedSettings.dyslexiaFont ? 'Open Dyslexic' : 'Inter';
                    delete loadedSettings.dyslexiaFont;
                }
                return loadedSettings;
            } catch (e) {
                console.error("Error loading settings from localStorage:", e);
                return defaultSettings;
            }
        }

        function applyHeadSettings(settings) {
            const docEl = document.documentElement;

            docEl.style.setProperty('--site-font-size', `${settings.fontSize}rem`);
            docEl.style.setProperty('--site-line-height', settings.lineHeight);
            docEl.style.setProperty('--site-letter-spacing', `${settings.letterSpacing}px`);
            docEl.style.setProperty('--site-word-spacing', `${settings.wordSpacing}px`);

            let fontName = settings.fontFamily || 'Inter';
            // Ensure font names with spaces are quoted when setting the CSS variable
            if (fontName.includes(' ') || fontName === 'Open Dyslexic') {
                fontName = `"${fontName}"`;
            }
            docEl.style.setProperty('--site-font-family', fontName);
        }

        // Functions to update the Accessibility Panel UI state (critical for user feedback)
        function updateFontButtonUI(selectedFont) {
            const fontSelectors = document.querySelectorAll('.font-selector');
            fontSelectors.forEach(btn => {
                const selectedFontName = (selectedFont || 'Inter').replace(/"/g, '');
                const btnFontName = btn.dataset.font.replace(/"/g, '');

                // Pure CSS class toggling
                if (btnFontName === selectedFontName) {
                    btn.classList.add('selected-btn');
                } else {
                    btn.classList.remove('selected-btn');
                }
            });
        }

        function updateThemeButtonUI(selectedTheme) {
            const themeSelectors = document.querySelectorAll('.theme-selector');
            themeSelectors.forEach(btn => {
                if (btn.dataset.theme === selectedTheme) {
                    btn.classList.add('selected-btn');
                } else {
                    btn.classList.remove('selected-btn');
                }
            });
        }

        function applyBodySettings(settings) {
            const body = document.body;
            if (!body) return;

            // 1. Theme
            body.classList.remove('light', 'dark', 'high-contrast');
            body.classList.add(settings.theme);

            // 2. Accessibility Utilities
            body.classList.toggle('reduced-motion', settings.reducedMotion);
            body.classList.toggle('highlight-links', settings.highlightLinks);
            body.classList.toggle('readable-width', settings.readableWidth);

            // Update the font buttons UI
            updateFontButtonUI(settings.fontFamily);
            // Update the theme buttons UI
            updateThemeButtonUI(settings.theme);
        }

        function applySettings(settings) {
            applyHeadSettings(settings);
            applyBodySettings(settings);
        }

        let currentSettings = loadSettings();

        function saveSettings(settings) {
            try {
                localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));
                currentSettings = settings; // Update global state
                applySettings(settings); // Apply settings on save
            } catch (e) {
                console.error("Error saving settings to localStorage:", e);
            }
        }

        // Apply head settings immediately before body loads
        applyHeadSettings(currentSettings);
    </script>

    <!-- Custom Styles for ALL LAYOUT, THEMES, and ACCESSIBILITY -->
    <style>
        /* FIX: Define Open Dyslexic font face using the preloaded OTF file */
        @font-face {
            font-family: 'Open Dyslexic';
            src: url('font/OpenDyslexic/OpenDyslexic-Regular.otf') format('opentype');
            font-weight: normal;
            font-style: normal;
            /* Using a common path assumption; user must ensure 'font/' folder exists */
        }

        /* CSS Variables & Custom Fonts */
        :root {
            /* Fallback variables for initial load */
            --color-primary: #4F46E5;
            --color-secondary: #6366F1;
            --color-accent: #818CF8;
            --color-base-bg: #F9FAFB;
            --color-content-bg: #FFFFFF;
            --color-card-bg: #FFFFFF;
            --color-header-bg: #FFFFFF;
            --color-footer-bg-from: #1F2937;
            --color-footer-bg-to: #374151;
            --color-link: #4F46E5;
            --color-text-default: #1F2937;
            --color-text-secondary: #6B7280;
            --color-hero-bg-from: #4F46E5;
            --color-hero-bg-to: #6366F1;
            --border-radius-base: 0.75rem;

            --site-font-size: 1rem;
            --site-line-height: 1.6;
            --site-letter-spacing: normal;
            --site-word-spacing: normal;
            --site-font-family: 'Inter', sans-serif;
            /* Default font */
        }

        /* Base styles from dynamic variables */
        body {
            background-color: var(--color-base-bg);
            color: var(--color-text-default);
            font-size: var(--site-font-size);
            line-height: var(--site-line-height);
            font-family: var(--site-font-family);
            letter-spacing: var(--site-letter-spacing);
            word-spacing: var(--site-word-spacing);
            transition: background-color 0.3s, color 0.3s, opacity 0.3s;
            min-height: 100vh;
            margin: 0;
            padding: 0;
        }

        /* Link base style */
        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--color-secondary);
        }

        /* Headings */
        h1,
        h2,
        h3,
        h4 {
            color: var(--color-text-default);
            font-weight: 800;
        }

        h1 {
            font-size: 2.5rem;
        }

        h2 {
            font-size: 2rem;
            letter-spacing: -0.025em;
        }

        h3 {
            font-size: 1.5rem;
        }

        /* --- THEMES (Define CSS Variables) --- */

        /* Dark Mode */
        .dark {
            --color-primary: #6366F1;
            --color-secondary: #818CF8;
            --color-accent: #A5B4FC;
            --color-base-bg: #1A202C;
            --color-content-bg: #2D3748;
            --color-card-bg: #2D3748;
            --color-header-bg: #2D3748;
            --color-footer-bg-from: #4c51bf;
            --color-footer-bg-to: #5a67d8;
            --color-link: #A5B4FC;
            --color-text-default: #E2E8F0;
            --color-text-secondary: #CBD5E0;
            --color-hero-bg-from: #4F46E5;
            --color-hero-bg-to: #5a67d8;
        }

        .dark .shadow-lg {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.5), 0 4px 6px -2px rgba(0, 0, 0, 0.2);
        }

        /* High Contrast Mode */
        .high-contrast {
            --color-primary: #FFFF00;
            --color-secondary: #00FFFF;
            --color-accent: #00FFFF;
            --color-base-bg: #000000;
            --color-content-bg: #333333;
            --color-card-bg: #333333;
            --color-header-bg: #111111;
            --color-footer-bg-from: #111111;
            --color-footer-bg-to: #111111;
            --color-link: #FFFF00;
            --color-text-default: #FFFF00;
            --color-text-secondary: #FFFFFF;
            --color-hero-bg-from: #111111;
            --color-hero-bg-to: #333333;
            --border-radius-base: 0;
        }

        .high-contrast .btn-primary {
            background-color: #000000 !important;
            border: 2px solid #FFFF00 !important;
            color: #FFFF00 !important;
        }

        .high-contrast .shadow-lg,
        .high-contrast .shadow-2xl {
            box-shadow: 0 0 10px #FFFF00;
        }

        .high-contrast a,
        .high-contrast .text-primary {
            color: var(--color-link) !important;
        }

        /* --- LAYOUT AND UTILITIES --- */
        .container-main {
            max-width: 1280px;
            margin-left: auto;
            margin-right: auto;
            padding-left: 1rem;
            padding-right: 1rem;
        }

        .section-padding {
            padding-top: 4rem;
            padding-bottom: 4rem;
        }

        /* Buttons and Interactive Elements */
        .btn-base {
            padding: 0.75rem 2rem;
            border-radius: 9999px;
            font-weight: 700;
            text-align: center;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease-in-out;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.06);
            cursor: pointer;
        }

        .btn-primary {
            background-color: #FFFFFF;
            color: var(--color-primary);
        }

        .btn-primary:hover {
            background-color: #F3F4F6;
            transform: scale(1.05);
        }

        .btn-secondary {
            background-color: transparent;
            border: 2px solid #FFFFFF;
            color: #FFFFFF;
        }

        .btn-secondary:hover {
            background-color: #FFFFFF;
            color: var(--color-primary);
            transform: scale(1.05);
        }

        /* Accessibility Panel Button */
        .a11y-toggle-btn {
            position: fixed;
            bottom: 1.5rem;
            right: 1.5rem;
            z-index: 50;
            padding: 1rem;
            background-color: var(--color-primary);
            color: white;
            border-radius: 9999px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.4);
            transition: all 0.3s;
            transform: scale(1.0);
            border: none;
            /* Remove default button border */
        }

        .a11y-toggle-btn:hover {
            background-color: var(--color-secondary);
            transform: scale(1.1);
        }

        /* Announcement Bar */
        .announcement-bar {
            background-color: var(--color-primary);
            color: white;
            padding: 0.5rem 0;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            width: 100%;
            transition: background-color 0.3s;
        }

        /* Site Header */
        .site-header {
            position: sticky;
            top: 42px;
            /* Adjusted if announcement bar is visible */
            z-index: 40;
            background-color: var(--color-header-bg);
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            transition: top 0.3s, background-color 0.3s, box-shadow 0.3s;
            padding: 1rem 0;
        }

        /* FIX: Header top position when announcement is closed */
        .site-header.fixed-top {
            top: 0px !important;
        }

        /* --- Navigation Styles --- */
        .site-nav {
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
        }

        .nav-link {
            display: flex;
            align-items: center;
            /* Ensures icon and text are aligned */
            margin-top: 1rem;
            color: var(--color-text-default);
            padding: 0.5rem 0.75rem;
            border-radius: 0.5rem;
            transition: color 0.2s, background-color 0.2s;
            font-weight: 500;
        }

        .nav-link:hover {
            color: var(--color-primary);
            background-color: rgba(79, 70, 229, 0.1);
        }

        /* Mobile Menu Toggle */
        #nav-content {
            width: 100%;
            display: none;
            /* Hidden by default on mobile */
        }

        #nav-content.is-open {
            display: block;
        }

        /* Desktop Navigation */
        @media (min-width: 1024px) {
            #nav-content {
                display: flex;
                width: auto;
                flex-grow: 1;
                align-items: center;
                justify-content: space-between;
                /* Distributes links and utilities */
            }

            .nav-links-container {
                display: flex;
                justify-content: flex-start;
                /* Aligns links to the left of the utility bar */
            }

            .nav-utility-container {
                display: flex;
                align-items: center;
                gap: 1rem;
                /* Spacing between search and user icon */
                margin-left: auto;
                /* Pushes utility items to the right */
            }

            .nav-link {
                display: inline-flex;
                margin-top: 0;
                margin-left: 1rem;
                /* Added margin-left for spacing */
            }
        }

        /* Search Bar */
        .search-container {
            position: relative;
            margin-top: 1rem;
        }

        .search-input {
            background-color: var(--color-base-bg);
            color: var(--color-text-default);
            border: 1px solid #D1D5DB;
            border-radius: 9999px;
            padding: 0.5rem 1rem 0.5rem 2.5rem;
            width: 100%;
            transition: all 0.3s;
            /* Smooth transition for focus effects */
        }

        .search-input:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 0 2px rgba(79, 70, 229, 0.3);
        }

        .search-icon {
            position: absolute;
            left: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--color-text-secondary);
        }

        @media (min-width: 1024px) {
            .search-container {
                margin-top: 0;
                width: 12rem;
            }

            .search-input {
                width: 12rem;
            }
        }

        /* User Icon Button */
        .user-profile-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 9999px;
            background-color: var(--color-primary);
            color: white;
            transition: transform 0.2s, opacity 0.2s;
            border: 2px solid transparent;
        }

        .user-profile-btn:hover {
            transform: scale(1.1);
            opacity: 0.9;
        }

        /* --- Hero Section --- */
        .hero-section {
            background: linear-gradient(135deg, var(--color-hero-bg-from), var(--color-hero-bg-to));
            color: white;
            padding: 5rem 1rem;
            text-align: center;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);
            transition: all 0.5s ease-in-out;
            border-bottom-left-radius: 1rem;
            /* Rounded corners for the bottom */
            border-bottom-right-radius: 1rem;
            /* Rounded corners for the bottom */
        }

        .hero-title {
            font-size: 2.5rem;
            font-weight: 800;
            line-height: 1.2;
            margin-bottom: 1rem;
            color: white;
        }

        .hero-subtitle {
            font-size: 1.25rem;
            font-weight: 300;
            margin-bottom: 2rem;
            opacity: 0.9;
            color: white;
        }

        .hero-btn-group {
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 1rem;
        }

        @media (min-width: 640px) {
            .hero-title {
                font-size: 3rem;
            }

            .hero-subtitle {
                font-size: 1.5rem;
            }

            .hero-btn-group {
                flex-direction: row;
                gap: 1rem;
            }
        }

        @media (min-width: 768px) {
            .hero-title {
                font-size: 3.75rem;
            }
        }

        /* --- Feature Cards & Curriculum Grid --- */
        .grid-layout {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }

        .feature-card,
        .level-card {
            background-color: var(--color-content-bg);
            border-radius: var(--border-radius-base);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.05);
            padding: 2rem;
            text-align: center;
            transition: transform 0.3s, box-shadow 0.3s;
            border-bottom-width: 4px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .feature-card:hover,
        .level-card:hover {
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
            transform: scale(1.02);
            /* hover:scale-[1.02] */
        }

        .feature-card h3,
        .level-card h3 {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
        }

        .feature-card p,
        .level-card p {
            color: var(--color-text-secondary);
            font-size: 0.875rem;
        }

        /* Feature Card Specific Colors */
        .feature-card:nth-child(3n+1) {
            border-color: var(--color-primary);
        }

        .feature-card:nth-child(3n+2) {
            border-color: var(--color-secondary);
        }

        .feature-card:nth-child(3n) {
            border-color: var(--color-accent);
        }

        /* Grid Responsiveness */
        @media (min-width: 768px) {
            .features-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (min-width: 640px) {
            .curriculum-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 1024px) {
            .curriculum-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (min-width: 1280px) {
            .curriculum-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        /* Level Card Specific Colors & Link styles */
        .level-card:nth-child(4n+1) {
            border-color: var(--color-primary);
        }

        .level-card:nth-child(4n+2) {
            border-color: var(--color-secondary);
        }

        .level-card:nth-child(4n+3) {
            border-color: var(--color-accent);
        }

        .level-card:nth-child(4n+4) {
            border-color: var(--color-secondary);
        }

        .level-card a {
            color: inherit;
            /* Inherit color from the context */
            margin-top: 1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
        }

        .level-card:nth-child(4n+1) a {
            color: var(--color-primary);
        }

        .level-card:nth-child(4n+2) a {
            color: var(--color-secondary);
        }

        .level-card:nth-child(4n+3) a {
            color: var(--color-accent);
        }

        .level-card:nth-child(4n+4) a {
            color: var(--color-secondary);
        }

        /* --- Footer --- */
        .site-footer {
            background: linear-gradient(to right, var(--color-footer-bg-from), var(--color-footer-bg-to));
            color: white;
            padding: 2.5rem 1rem;
            border-top-left-radius: 1rem;
            border-top-right-radius: 1rem;
            box-shadow: 0 -10px 20px rgba(0, 0, 0, 0.2);
            transition: background 0.3s;
        }

        .footer-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 2rem;
            max-width: 1280px;
            margin: 0 auto;
        }

        @media (min-width: 768px) {
            .footer-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        .site-footer h3 {
            color: white;
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
        }

        .site-footer a {
            color: var(--color-accent);
            opacity: 0.9;
            transition: color 0.2s;
        }

        .site-footer a:hover {
            color: white;
            text-decoration: underline;
        }

        .footer-bottom {
            margin-top: 2.5rem;
            border-top: 1px solid var(--color-accent);
            padding-top: 1.5rem;
            text-align: center;
            font-size: 0.875rem;
            opacity: 0.9;
        }

        /* --- ACCESSIBILITY PANEL --- */
        .a11y-panel {
            position: fixed;
            top: 0;
            right: 0;
            height: 100%;
            width: 20rem;
            /* w-80 */
            background-color: var(--color-content-bg);
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
            z-index: 50;
            transform: translateX(100%);
            transition: transform 0.3s ease-in-out;
            overflow-y: auto;
            padding: 1.5rem;
            border-left: 4px solid var(--color-primary);
            /* Accent border */
        }

        .a11y-panel-open {
            transform: translateX(0);
        }

        .panel-group {
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
        }

        .panel-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: var(--color-text-default);
        }

        .a11y-panel button {
            border: 1px solid #D1D5DB;
            background-color: var(--color-content-bg);
            color: var(--color-text-default);
            transition: all 0.2s;
            border-radius: 0.5rem;
            padding: 0.5rem;
        }

        .a11y-panel button.selected-btn {
            background-color: var(--color-primary);
            color: white;
            border-color: var(--color-primary);
        }

        .a11y-panel button:hover:not(.selected-btn) {
            background-color: #F3F4F6;
        }

        .dark .a11y-panel button {
            border-color: #4B5563;
        }

        .dark .a11y-panel button:hover:not(.selected-btn) {
            background-color: #4A5568;
        }

        .font-selection-grid,
        .theme-selection-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.5rem;
        }

        .font-selection-grid {
            grid-template-columns: repeat(4, 1fr);
            font-size: 0.75rem;
            font-weight: 600;
        }

        /* Slider Styles */
        input[type="range"] {
            width: 100%;
            height: 0.5rem;
            background-color: #E5E7EB;
            border-radius: 0.5rem;
            cursor: pointer;
            appearance: none;
            /* For Firefox */
            -webkit-appearance: none;
            /* For Chrome/Safari */
            margin: 0;
        }

        input[type="range"]:focus {
            outline: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 1rem;
            height: 1rem;
            background: var(--color-primary);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
            transition: background 0.2s;
        }

        input[type="range"]::-moz-range-thumb {
            width: 1rem;
            height: 1rem;
            background: var(--color-primary);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
        }

        /* Toggle Switch Styles */
        .toggle-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        /* --- ACCESSIBILITY UTILITIES --- */

        /* Reduced Motion */
        .reduced-motion * {
            transition-duration: 0s !important;
            animation-duration: 0s !important;
            scroll-behavior: auto !important;
        }

        /* Highlight Links */
        .highlight-links a {
            text-decoration: underline !important;
            text-decoration-thickness: 2px !important;
            background-color: #FFFF00 !important;
            color: #000000 !important;
            padding: 2px 4px;
            border-radius: 3px;
        }

        .highlight-links footer a {
            background-color: #FFFF00 !important;
            color: #000000 !important;
        }

        /* Readable Width */
        .readable-width main {
            max-width: 70ch;
            margin-left: auto;
            margin-right: auto;
        }

        /* Reading Mask/Guide (Same as before, relies on CSS variables) */
        #reading-mask {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            pointer-events: none;
            z-index: 50;
            transition: background-color 0s;
        }

        #reading-guide {
            position: absolute;
            width: 100%;
            height: var(--guide-height, 2.5rem);
            background-color: rgba(255, 255, 255, 0.1);
            border-top: 2px solid var(--color-base-bg);
            border-bottom: 2px solid var(--color-base-bg);
            cursor: grab;
            pointer-events: auto;
            transition: background-color 0.3s;
            top: 30%;
        }

        .dark #reading-guide,
        .high-contrast #reading-guide {
            background-color: rgba(255, 255, 255, 0.05);
            border-top: 2px solid var(--color-text-default);
            border-bottom: 2px solid var(--color-text-default);
        }

        /* Custom Scrollbar (Cross-browser compatibility is limited to webkit) */
        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--color-base-bg);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--color-primary);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--color-secondary);
        }

        .dark ::-webkit-scrollbar-track {
            background: #2D3748;
        }

        .dark ::-webkit-scrollbar-thumb {
            background: var(--color-primary);
        }

        /* Utility */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        /* Custom Toggle Switch - Replicating Tailwind Toggle Look */
        .toggle {
            appearance: none;
            width: 3rem;
            height: 1.5rem;
            border-radius: 9999px;
            background-color: #CBD5E0;
            position: relative;
            transition: background-color 0.3s;
            cursor: pointer;
        }

        .toggle:checked {
            background-color: var(--color-primary);
        }

        .toggle::before {
            content: "";
            position: absolute;
            top: 0.25rem;
            left: 0.25rem;
            width: 1rem;
            height: 1rem;
            border-radius: 9999px;
            background-color: white;
            transition: transform 0.3s;
        }

        .toggle:checked::before {
            transform: translateX(1.5rem);
        }

        /* Announcement Scroll Fix */
        .announcement-bar .content-wrapper {
            overflow: hidden;
            white-space: nowrap;
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 1rem;
            flex: 1;
        }

        .announcement-content {
            animation: scroll-left 25s linear infinite;
            padding-right: 100%;
            display: inline-block;
        }

        .announcement-item {
            display: inline-block;
            padding: 0 1rem;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .announcement-divider {
            color: var(--color-accent);
        }

        @keyframes scroll-left {
            0% {
                transform: translateX(0);
            }

            100% {
                transform: translateX(-50%);
            }
        }

        .close-announcement-btn {
            position: absolute;
            right: 0.25rem;
            top: 50%;
            transform: translateY(-50%);
            padding: 0.5rem;
            color: white;
            transition: color 0.2s;
            border: none;
            background: none;
        }

        .close-announcement-btn:hover {
            color: var(--color-accent);
        }
    </style>
</head>

<body class="antialiased light">

    <!-- Apply Body Settings on load -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // This immediately applies all body classes and updates the UI for the panel buttons
            applySettings(currentSettings);
        });
    </script>

    <!-- ACCESSIBILITY SETTINGS PANEL BUTTON -->
    <button id="a11y-toggle-button" class="a11y-toggle-btn" aria-label="Toggle Accessibility Settings Panel"
        aria-controls="a11y-settings-panel">
        <i class="fas fa-universal-access text-2xl"></i>
    </button>

    <!-- ACCESSIBILITY SETTINGS PANEL (SIDEBAR) -->
    <div id="a11y-settings-panel" class="a11y-panel" role="dialog" aria-modal="true"
        aria-label="Accessibility and Display Settings" aria-hidden="true">
        <div class="panel-group" style="border-bottom: 1px solid #E5E7EB; padding-bottom: 1rem;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                <h3 class="text-xl" style="font-weight: 700; color: var(--color-primary);">Accessibility Settings</h3>
                <button id="a11y-close-button"
                    style="color: var(--color-text-secondary); padding: 0.5rem; border-radius: 9999px; border: none; background: none;"
                    aria-label="Close settings panel">
                    <i class="fas fa-times text-lg"></i>
                </button>
            </div>

            <!-- Theme Settings -->
            <div class="panel-group">
                <label class="panel-label">Display Mode</label>
                <div class="theme-selection-grid">
                    <button id="theme-light" data-theme="light" class="theme-selector" aria-label="Set theme to Light">
                        <i class="fas fa-sun mr-1"></i> Light
                    </button>
                    <button id="theme-dark" data-theme="dark" class="theme-selector" aria-label="Set theme to Dark">
                        <i class="fas fa-moon mr-1"></i> Dark
                    </button>
                    <button id="theme-contrast" data-theme="high-contrast" class="theme-selector"
                        aria-label="Set theme to High Contrast">
                        <i class="fas fa-low-vision mr-1"></i> Contrast
                    </button>
                </div>
            </div>

            <!-- Font Selection -->
            <div class="panel-group">
                <label class="panel-label">Reading Font</label>
                <div id="font-selection-buttons" class="font-selection-grid">
                    <button data-font="Inter" class="font-selector">Default</button>
                    <button data-font="Merriweather" class="font-selector">Serif</button>
                    <button data-font="Open Dyslexic" class="font-selector">Dyslexic</button>
                    <button data-font="Roboto Mono" class="font-selector">Mono</button>
                </div>
            </div>

            <!-- Text Size Slider -->
            <div class="panel-group">
                <label for="font-size-slider" class="panel-label">Text Size (<span
                        id="font-size-value">100</span>%)</label>
                <input type="range" id="font-size-slider" min="0.8" max="1.6" step="0.1" value="1.0">
                <div
                    style="display: flex; justify-content: space-between; font-size: 0.75rem; margin-top: 0.25rem; color: var(--color-text-secondary);">
                    <span>Small (80%)</span>
                    <span>Default (100%)</span>
                    <span>Large (160%)</span>
                </div>
            </div>

            <!-- Line Height Slider -->
            <div class="panel-group">
                <label for="line-height-slider" class="panel-label">Line Height
                    (<span id="line-height-value">1.6</span>)</label>
                <input type="range" id="line-height-slider" min="1.3" max="2.0" step="0.1" value="1.6">
                <div
                    style="display: flex; justify-content: space-between; font-size: 0.75rem; margin-top: 0.25rem; color: var(--color-text-secondary);">
                    <span>Compact (1.3)</span>
                    <span>Spacious (2.0)</span>
                </div>
            </div>

            <!-- Letter Spacing Slider -->
            <div class="panel-group">
                <label for="letter-spacing-slider" class="panel-label">Letter
                    Spacing
                    (<span id="letter-spacing-value">0</span>px)</label>
                <input type="range" id="letter-spacing-slider" min="-1" max="3" step="0.5" value="0">
                <div
                    style="display: flex; justify-content: space-between; font-size: 0.75rem; margin-top: 0.25rem; color: var(--color-text-secondary);">
                    <span>Tight (-1px)</span>
                    <span>Wide (3px)</span>
                </div>
            </div>

            <!-- Word Spacing Slider -->
            <div class="panel-group">
                <label for="word-spacing-slider" class="panel-label">Word Spacing
                    (<span id="word-spacing-value">0</span>px)</label>
                <input type="range" id="word-spacing-slider" min="0" max="5" step="0.5" value="0">
                <div
                    style="display: flex; justify-content: space-between; font-size: 0.75rem; margin-top: 0.25rem; color: var(--color-text-secondary);">
                    <span>Default (0px)</span>
                    <span>Spacious (5px)</span>
                </div>
            </div>

            <hr style="border-top: 1px solid #E5E7EB; margin: 1.5rem 0;">

            <!-- Highlight Links Toggle -->
            <div class="panel-group">
                <label for="toggle-highlight-links" class="panel-label">Highlight
                    Links</label>
                <div class="toggle-row">
                    <span style="color: var(--color-text-secondary); font-size: 0.875rem;">Underline and highlight all
                        links</span>
                    <input type="checkbox" id="toggle-highlight-links" class="toggle" role="switch"
                        aria-checked="false">
                </div>
            </div>

            <!-- Readable Width Toggle -->
            <div class="panel-group">
                <label for="toggle-readable-width" class="panel-label">Readable
                    Width</label>
                <div class="toggle-row">
                    <span style="color: var(--color-text-secondary); font-size: 0.875rem;">Constrain main content
                        width</span>
                    <input type="checkbox" id="toggle-readable-width" class="toggle" role="switch" aria-checked="false">
                </div>
            </div>

            <!-- Reduced Motion Toggle -->
            <div class="panel-group">
                <label for="toggle-reduced-motion" class="panel-label">Reduce
                    Animations</label>
                <div class="toggle-row">
                    <span style="color: var(--color-text-secondary); font-size: 0.875rem;">Disable transitions and
                        animations</span>
                    <input type="checkbox" id="toggle-reduced-motion" class="toggle" role="switch" aria-checked="false">
                </div>
            </div>

            <!-- Reset Button -->
            <button id="reset-a11y-settings"
                style="width: 100%; background-color: #E5E7EB; color: #374151; padding: 0.5rem; border-radius: 0.5rem; margin-top: 1rem; border: none; font-weight: 600;"
                class="reset-btn">
                Reset All Settings
            </button>
        </div>
    </div>


    <!-- Announcement Section (Fixed Top Bar) -->
    <div id="announcement-bar" class="announcement-bar" role="region" aria-label="Site Announcement">
        <div class="content-wrapper">
            <div class="announcement-content">
                <span class="announcement-item">
                    <i class="fas fa-bullhorn" style="margin-right: 0.5rem;"></i> Exciting news! We're rolling out new
                    features weekly.
                </span>
                <span class="announcement-divider" aria-hidden="true">&bull;</span>
                <span class="announcement-item">
                    <i class="fas fa-envelope" style="margin-right: 0.5rem;"></i> Have a feature request? Email me at <a
                        href="mailto:admin@hestena62.com"
                        style="font-weight: 700; text-decoration: underline; color: white;">admin@hestena62.com</a>
                </span>
                <span class="announcement-divider" aria-hidden="true">&bull;</span>
                <!-- Duplicated content for smooth scrolling animation -->
                <span class="announcement-item">
                    <i class="fas fa-bullhorn" style="margin-right: 0.5rem;"></i> Exciting news! We're rolling out new
                    features weekly.
                </span>
                <span class="announcement-divider" aria-hidden="true">&bull;</span>
            </div>
        </div>
        <button id="close-announcement" class="close-announcement-btn" aria-label="Close announcement">
            <i class="fas fa-times" aria-hidden="true"></i>
        </button>
    </div>

    <!-- Navigation Bar -->
    <header id="site-header" class="site-header">
        <div class="container-main">
            <nav class="site-nav" aria-label="Main navigation">
                <!-- Logo and brand name -->
                <a class="nav-brand" href="/"
                    style="display: flex; align-items: center; color: var(--color-text-default);">
                    <img src="https://placehold.co/32x32/4F46E5/FFFFFF?text=HL" alt="Company Logo"
                        style="border-radius: 9999px; height: 2rem; width: 2rem; margin-right: 0.5rem;" />
                    <span
                        style="font-weight: 800; font-size: 1.25rem; letter-spacing: -0.05em; color: var(--color-primary); transition: color 0.3s;">
                        Hesten's Learning
                    </span>
                </a>

                <!-- Mobile menu button -->
                <div class="nav-toggle-wrapper">
                    <button id="nav-toggle"
                        style="display: flex; align-items: center; padding: 0.5rem 0.75rem; border-radius: 0.5rem; border: 1px solid var(--color-text-secondary); color: var(--color-text-secondary); transition: all 0.2s;"
                        aria-controls="nav-content" aria-expanded="false">
                        <svg class="fill-current" style="height: 1.25rem; width: 1.25rem;" viewBox="0 0 24 24"
                            xmlns="http://www.w3.org/2000/svg">
                            <title>Menu</title>
                            <!-- Updated path for clearer icon -->
                            <path d="M4 6h16v2H4zm0 5h16v2H4zm0 5h16v2H4z" fill="currentColor" />
                        </svg>
                        <span class="sr-only">Toggle navigation menu</span>
                    </button>
                </div>

                <!-- Navigation links and search/profile -->
                <div id="nav-content" aria-hidden="true">
                    <!-- Nav Links -->
                    <div class="nav-links-container">
                        <a href="/" class="nav-link">
                            <i class="fas fa-home" style="margin-right: 0.5rem;"></i> Home
                        </a>
                        <a href="#levels" class="nav-link">
                            <i class="fas fa-book-open" style="margin-right: 0.5rem;"></i> Curriculum
                        </a>
                        <a href="/assessment.php" class="nav-link">
                            <i class="fas fa-clipboard-check" style="margin-right: 0.5rem;"></i> Assessment
                        </a>
                        <a href="/about.php" class="nav-link">
                            <i class="fas fa-info-circle" style="margin-right: 0.5rem;"></i> About
                        </a>
                    </div>

                    <!-- Search bar and Profile Icon (Utility Group) -->
                    <div class="nav-utility-container">
                        <!-- Search bar -->
                        <div class="search-container">
                            <form id="search-form" action="/search.php" method="GET" role="search">
                                <label for="search-input" class="sr-only">Search courses</label>
                                <input type="text" id="search-input" name="q" placeholder="Search..."
                                    class="search-input" />
                                <i class="fas fa-search search-icon" aria-hidden="true"></i>
                            </form>
                        </div>
                        <!-- Profile Icon -->
                        <a href="/profile.php" class="user-profile-btn" aria-label="User Profile and Login">
                            <i class="fas fa-user text-lg"></i>
                        </a>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <!-- Hero Section - Focus on Clarity and Mission -->
    <section id="hero-section" class="hero-section">
        <div style="max-width: 56rem; margin: 0 auto;">
            <h1 class="hero-title">
                Empowering Every Learner
            </h1>
            <p class="hero-subtitle">
                Personalized educational experiences built for students with learning differences.
            </p>
            <div class="hero-btn-group">
                <a href="#levels" class="btn-base btn-primary">
                    <i class="fas fa-compass" style="margin-right: 0.5rem;"></i> Start Exploring
                </a>
                <a href="/about.php" class="btn-base btn-secondary">
                    <i class="fas fa-lightbulb" style="margin-right: 0.5rem;"></i> Our Mission
                </a>
            </div>
        </div>
    </section>

    <!-- Features Section - Why Choose Hesten's Learning? -->
    <section class="container-main section-padding" aria-labelledby="why-choose-us">
        <h2 id="why-choose-us"
            style="font-size: 2.25rem; font-weight: 800; text-align: center; margin-bottom: 3rem; color: var(--color-text-default); letter-spacing: -0.025em;">
            A Different Approach to Learning
        </h2>

        <div class="grid-layout features-grid">

            <!-- Feature 1: Personalized Pathways -->
            <div class="feature-card">
                <i class="fas fa-route" style="font-size: 3rem; color: var(--color-primary); margin-bottom: 1rem;"
                    aria-hidden="true"></i>
                <h3
                    style="font-size: 1.25rem; font-weight: 600; color: var(--color-text-default); margin-bottom: 0.75rem;">
                    Customized Learning Pathways
                </h3>
                <p style="color: var(--color-text-secondary); font-size: 0.875rem;">
                    Our platform dynamically adjusts to each student's pace and style, ensuring content is always
                    challenging, but
                    never overwhelming. True personalized mastery.
                </p>
            </div>

            <!-- Feature 2: Built-in Accessibility -->
            <div class="feature-card">
                <i class="fas fa-universal-access"
                    style="font-size: 3rem; color: var(--color-secondary); margin-bottom: 1rem;" aria-hidden="true"></i>
                <h3
                    style="font-size: 1.25rem; font-weight: 600; color: var(--color-text-default); margin-bottom: 0.75rem;">
                    Dyslexia-Friendly by Design
                </h3>
                <p style="color: var(--color-text-secondary); font-size: 0.875rem;">
                    Built with robust accessibility features, including Open Dyslexic font support, high-contrast modes,
                    and
                    adjustable spacing for maximum readability.
                </p>
            </div>

            <!-- Feature 3: All-Subject Curriculum -->
            <div class="feature-card">
                <i class="fas fa-cubes" style="font-size: 3rem; color: var(--color-accent); margin-bottom: 1rem;"
                    aria-hidden="true"></i>
                <h3
                    style="font-size: 1.25rem; font-weight: 600; color: var(--color-text-default); margin-bottom: 0.75rem;">
                    Comprehensive K-5 Content
                </h3>
                <p style="color: var(--color-text-secondary); font-size: 0.875rem;">
                    From foundational math and ELA to introductory science and social studies, we cover all the core
                    subjects
                    necessary for academic growth.
                </p>
            </div>

        </div>
    </section>

    <!-- Main Content - Curriculum Levels Grid -->
    <main class="container-main section-padding">
        <h2 id="levels"
            style="font-size: 2.25rem; font-weight: 800; text-align: center; margin-bottom: 3rem; color: var(--color-text-default); letter-spacing: -0.025em;">
            Curriculum & Learning Levels
        </h2>

        <section class="grid-layout curriculum-grid" aria-labelledby="levels">
            <!-- Mock Data for Preview -->
            <article class="level-card" style="border-top: 8px solid var(--color-primary);">
                <h3 style="font-size: 1.5rem; font-weight: 700; color: var(--color-primary); margin-bottom: 0.75rem;">
                    Pre-K</h3>
                <p style="color: var(--color-text-secondary); margin-bottom: 1rem; flex-grow: 1;">
                    Counting objects, letter names, rhyming words, and more. Foundational skills for early learners.
                </p>
                <a href="/Level/A.html">
                    Explore Skills <i class="fas fa-arrow-right" style="margin-left: 0.5rem; font-size: 0.875rem;"></i>
                </a>
            </article>

            <article class="level-card" style="border-top: 8px solid var(--color-secondary);">
                <h3 style="font-size: 1.5rem; font-weight: 700; color: var(--color-secondary); margin-bottom: 0.75rem;">
                    Kindergarten</h3>
                <p style="color: var(--color-text-secondary); margin-bottom: 1rem; flex-grow: 1;">
                    Basic math concepts, phonics, early reading, and more. Building blocks for a strong academic start.
                </p>
                <a href="/Level/B.html">
                    Explore Skills <i class="fas fa-arrow-right" style="margin-left: 0.5rem; font-size: 0.875rem;"></i>
                </a>
            </article>

            <article class="level-card" style="border-top: 8px solid var(--color-accent);">
                <h3 style="font-size: 1.5rem; font-weight: 700; color: var(--color-accent); margin-bottom: 0.75rem;">
                    Grade 1</h3>
                <p style="color: var(--color-text-secondary); margin-bottom: 1rem; flex-grow: 1;">
                    Adding, subtracting, sentence formation, and more. Key skills for developing independence in
                    learning.
                </p>
                <a href="/Level/C.html">
                    Explore Skills <i class="fas fa-arrow-right" style="margin-left: 0.5rem; font-size: 0.875rem;"></i>
                </a>
            </article>

            <article class="level-card" style="border-top: 8px solid var(--color-primary);">
                <h3 style="font-size: 1.5rem; font-weight: 700; color: var(--color-primary); margin-bottom: 0.75rem;">
                    Grade 2</h3>
                <p style="color: var(--color-text-secondary); margin-bottom: 1rem; flex-grow: 1;">
                    Basic multiplication, reading fluency, and more. Expanding foundational knowledge and skills.
                </p>
                <a href="/Level/B.html">
                    Explore Skills <i class="fas fa-arrow-right" style="margin-left: 0.5rem; font-size: 0.875rem;"></i>
                </a>
            </article>

            <article class="level-card" style="border-top: 8px solid var(--color-secondary);">
                <h3 style="font-size: 1.5rem; font-weight: 700; color: var(--color-secondary); margin-bottom: 0.75rem;">
                    Grade 3</h3>
                <p style="color: var(--color-text-secondary); margin-bottom: 1rem; flex-grow: 1;">
                    Multiplication, division, reading comprehension, and more. Critical thinking and problem-solving
                    development.
                </p>
                <a href="/Level/D.html">
                    Explore Skills <i class="fas fa-arrow-right" style="margin-left: 0.5rem; font-size: 0.875rem;"></i>
                </a>
            </article>

            <article class="level-card" style="border-top: 8px solid var(--color-accent);">
                <h3 style="font-size: 1.5rem; font-weight: 700; color: var(--color-accent); margin-bottom: 0.75rem;">
                    Grade 4</h3>
                <p style="color: var(--color-text-secondary); margin-bottom: 1rem; flex-grow: 1;">
                    Advanced multiplication, division, reading comprehension, and more. Deeper dives into academic
                    subjects.
                </p>
                <a href="/Level/D.html">
                    Explore Skills <i class="fas fa-arrow-right" style="margin-left: 0.5rem; font-size: 0.875rem;"></i>
                </a>
            </article>

            <article class="level-card" style="border-top: 8px solid var(--color-primary);">
                <h3 style="font-size: 1.5rem; font-weight: 700; color: var(--color-primary); margin-bottom: 0.75rem;">
                    Grade 5</h3>
                <p style="color: var(--color-text-secondary); margin-bottom: 1rem; flex-grow: 1;">
                    Decimals, essay writing, ecosystems, and more. Preparing for middle school academic rigor.
                </p>
                <a href="/Level/E.html">
                    Explore Skills <i class="fas fa-arrow-right" style="margin-left: 0.5rem; font-size: 0.875rem;"></i>
                </a>
            </article>

            <article class="level-card" style="border-top: 8px solid var(--color-secondary);">
                <h3 style="font-size: 1.5rem; font-weight: 700; color: var(--color-secondary); margin-bottom: 0.75rem;">
                    Test/Extra</h3>
                <p style="color: var(--color-text-secondary); margin-bottom: 1rem; flex-grow: 1;">
                    Practice with quizzes, review extra materials, and challenge yourself to master new topics across
                    all
                    subjects.
                </p>
                <a href="/test">
                    Explore Skills <i class="fas fa-arrow-right" style="margin-left: 0.5rem; font-size: 0.875rem;"></i>
                </a>
            </article>

        </section>
    </main>


    <!-- Footer -->
    <footer class="site-footer">
        <div class="footer-grid">
            <!-- About -->
            <div>
                <h3>
                    <i class="fas fa-graduation-cap" style="margin-right: 0.5rem;" aria-hidden="true"></i> Hesten's
                    Learning
                </h3>
                <p style="font-size: 0.875rem; opacity: 0.9;">
                    Empowering students with learning disabilities through personalized
                    learning experiences.
                    <a href="/about.php"
                        style="color: var(--color-accent); text-decoration: underline; margin-left: 0.25rem;">Learn
                        more</a>
                </p>
            </div>
            <!-- Quick Links -->
            <div>
                <h3 id="quick-links-heading">
                    <i class="fas fa-star" style="margin-right: 0.5rem;" aria-hidden="true"></i> Quick Links
                </h3>
                <nav aria-labelledby="quick-links-heading">
                    <ul style="list-style: none; padding: 0; margin-top: 0; font-size: 0.875rem;">
                        <li style="margin-bottom: 0.5rem;">
                            <a href="#levels"><i class="fas fa-book-open" style="margin-right: 0.5rem;"
                                    aria-hidden="true"></i>Curriculum</a>
                        </li>
                        <li style="margin-bottom: 0.5rem;">
                            <a href="/research"><i class="fas fa-flask" style="margin-right: 0.5rem;"
                                    aria-hidden="true"></i>Research</a>
                        </li>
                        <li style="margin-bottom: 0.5rem;">
                            <a href="/library"><i class="fas fa-book-reader" style="margin-right: 0.5rem;"
                                    aria-hidden="true"></i>Library</a>
                        </li>
                        <li style="margin-bottom: 0.5rem;">
                            <a href="/help.html"><i class="fas fa-question-circle" style="margin-right: 0.5rem;"
                                    aria-hidden="true"></i>Help Center</a>
                        </li>
                    </ul>
                </nav>
            </div>
            <!-- Support -->
            <div>
                <h3 id="support-heading">
                    <i class="fas fa-headset" style="margin-right: 0.5rem;" aria-hidden="true"></i> Support
                </h3>
                <nav aria-labelledby="support-heading">
                    <ul style="list-style: none; padding: 0; margin-top: 0; font-size: 0.875rem;">
                        <li style="margin-bottom: 0.5rem;">
                            <a href="/contact.html"><i class="fas fa-envelope" style="margin-right: 0.5rem;"
                                    aria-hidden="true"></i>Contact Us</a>
                        </li>
                        <li style="margin-bottom: 0.5rem;">
                            <a href="/students.html"><i class="fas fa-user-graduate" style="margin-right: 0.5rem;"
                                    aria-hidden="true"></i>For Students</a>
                        </li>
                        <li style="margin-bottom: 0.5rem;">
                            <a href="/parents.html"><i class="fas fa-users" style="margin-right: 0.5rem;"
                                    aria-hidden="true"></i>For Parents</a>
                        </li>
                        <li style="margin-bottom: 0.5rem;">
                            <a href="/teachers.html"><i class="fas fa-chalkboard-teacher" style="margin-right: 0.5rem;"
                                    aria-hidden="true"></i>For Teachers</a>
                        </li>
                    </ul>
                </nav>
            </div>
            <!-- Legal & Settings -->
            <div>
                <h3 id="legal-heading">
                    <i class="fas fa-gavel" style="margin-right: 0.5rem;" aria-hidden="true"></i> Legal
                </h3>
                <nav aria-labelledby="legal-heading">
                    <ul style="list-style: none; padding: 0; margin-top: 0; font-size: 0.875rem;">
                        <li style="margin-bottom: 0.5rem;">
                            <a href="/privacy.html"><i class="fas fa-shield-alt" style="margin-right: 0.5rem;"
                                    aria-hidden="true"></i>Privacy Policy</a>
                        </li>
                        <li style="margin-bottom: 0.5rem;">
                            <a href="/terms.html"><i class="fas fa-file-contract" style="margin-right: 0.5rem;"
                                    aria-hidden="true"></i>Terms of Use</a>
                        </li>
                        <li style="margin-bottom: 0.5rem;">
                            <a href="#"><i class="fas fa-universal-access" style="margin-right: 0.5rem;"
                                    aria-hidden="true"></i>Accessibility</a>
                        </li>
                        <li style="margin-bottom: 0.5rem;">
                            <a href="/about.php"><i class="fas fa-info-circle" style="margin-right: 0.5rem;"
                                    aria-hidden="true"></i>About Us</a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>

        <!-- Copyright and Creative Commons -->
        <div class="footer-bottom">
            <p>
                &copy; 2024 Hesten's Learning. All rights reserved.
                <span style="margin: 0 0.5rem;" aria-hidden="true">|</span>
                Made with <i class="fas fa-heart" style="color: #F87171;" aria-label="love"></i> for education
            </p>
            <p style="margin-top: 0.5rem;">
                <a property="dct:title" rel="cc:attributionURL" href="http://hestena62.com"
                    style="color: var(--color-accent); text-decoration: underline;">Hesten's
                    Learning</a>
                by
                <a rel="cc:attributionURL dct:creator" property="cc:attributionName" href="/about-me.php"
                    style="color: var(--color-accent); text-decoration: underline;">Hesten
                    Allison</a>
                is licensed under
                <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/?ref=chooser-v1" target="_blank"
                    rel="license noopener noreferrer" style="color: var(--color-accent); text-decoration: underline;">CC
                    BY-NC-SA 4.0</a>
            </p>
            <!-- Gtranslate Widget Placeholder -->
            <div class="gtranslate_wrapper" style="margin-top: 1rem;"></div>
            <script>
                // NOTE: The GTranslate script is provided as-is and uses external resources.
                window.gtranslateSettings = {
                    default_language: "en",
                    native_language_names: true,
                    detect_browser_language: true,
                    wrapper_selector: ".gtranslate_wrapper",
                    flag_style: "3d",
                    alt_flags: {
                        en: "usa"
                    },
                };
            </script>
            <script src="https://cdn.gtranslate.net/widgets/latest/popup.js" defer></script>
            <!-- Buy Me A Coffee Button Placeholder -->
            <div style="margin-top: 1rem; display: flex; justify-content: center; align-items: center; gap: 1rem;">
                <a href="https://www.buymeacoffee.com/hestena62l"
                    style="border-radius: 0.75rem; overflow: hidden; display: inline-block;">
                    <img src="https://img.buymeacoffee.com/button-api/?text=Buy me a coffee&emoji=&slug=hestena62&button_colour=BD5FFF&font_colour=ffffff&font_family=Cookie&outline_colour=000000&coffee_colour=FFDD00"
                        alt="Buy me a coffee" style="border-radius: 0.75rem;" />
                </a>
            </div>
        </div>
    </footer>

    <!-- Message Box Modal (Custom alert replacement) -->
    <div id="message-box"
        style="position: fixed; inset: 0; background-color: rgba(0, 0, 0, 0.75); display: none; align-items: center; justify-content: center; z-index: 100;"
        role="alertdialog" aria-modal="true" aria-labelledby="message-title">
        <div
            style="background-color: var(--color-content-bg); border-radius: var(--border-radius-base); box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3), 0 10px 10px -5px rgba(0, 0, 0, 0.2); padding: 1.5rem; max-width: 24rem; width: 100%; text-align: center; transition: transform 0.3s;">
            <h4 id="message-title"
                style="font-size: 1.25rem; font-weight: 700; margin-bottom: 1rem; color: var(--color-primary);">
                Notification</h4>
            <p id="message-text" style="margin-bottom: 1.5rem; color: var(--color-text-default);">This is a general
                message.</p>
            <button id="message-ok-button"
                style="background-color: var(--color-primary); color: white; padding: 0.5rem 1.5rem; border-radius: 0.5rem; font-weight: 600; border: none; transition: background-color 0.2s;"
                onmouseover="this.style.backgroundColor=getComputedStyle(document.documentElement).getPropertyValue('--color-secondary')"
                onmouseout="this.style.backgroundColor=getComputedStyle(document.documentElement).getPropertyValue('--color-primary')">
                OK
            </button>
        </div>
    </div>

    <!-- Confirmation Modal (Custom confirm replacement) -->
    <div id="confirmation-modal"
        style="position: fixed; inset: 0; background-color: rgba(0, 0, 0, 0.75); display: none; align-items: center; justify-content: center; z-index: 100;"
        role="dialog" aria-modal="true" aria-labelledby="confirmation-title">
        <div
            style="background-color: var(--color-content-bg); border-radius: var(--border-radius-base); box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3), 0 10px 10px -5px rgba(0, 0, 0, 0.2); padding: 1.5rem; max-width: 24rem; width: 100%; text-align: center; transition: transform 0.3s;">
            <h4 id="confirmation-title"
                style="font-size: 1.25rem; font-weight: 700; margin-bottom: 1rem; color: #EF4444;">Confirm Action</h4>
            <p id="confirmation-text" style="margin-bottom: 1.5rem; color: var(--color-text-default);">Are you sure you
                want to proceed?</p>
            <div style="display: flex; justify-content: center; gap: 1rem;">
                <button id="confirm-yes-button"
                    style="background-color: #EF4444; color: white; padding: 0.5rem 1.5rem; border-radius: 0.5rem; font-weight: 600; border: none; transition: background-color 0.2s;"
                    onmouseover="this.style.backgroundColor='#DC2626'"
                    onmouseout="this.style.backgroundColor='#EF4444'">
                    Yes
                </button>
                <button id="confirm-no-button"
                    style="background-color: #D1D5DB; color: #1F2937; padding: 0.5rem 1.5rem; border-radius: 0.5rem; font-weight: 600; border: none; transition: background-color 0.2s;"
                    onmouseover="this.style.backgroundColor='#9CA3AF'"
                    onmouseout="this.style.backgroundColor='#D1D5DB'">
                    No
                </button>
            </div>
        </div>
    </div>

    <!-- Site-wide Script (Modal, Navigation, and Accessibility Logic) -->
    <script>
        // --- GLOBAL MODAL FUNCTIONS (with focus trap) ---
        const messageBox = document.getElementById("message-box");
        const messageText = document.getElementById("message-text");
        const messageOkButton = document.getElementById("message-ok-button");
        const confirmationModal = document.getElementById("confirmation-modal");
        const confirmationText = document.getElementById("confirmation-text");
        const confirmYesButton = document.getElementById("confirm-yes-button");
        const confirmNoButton = document.getElementById("confirm-no-button");

        let lastFocusedElement = null; // Stores the element that was focused before the modal opened

        // A11Y: Function to handle focus trap in modals
        function trapFocus(modalElement) {
            const focusableElements = modalElement.querySelectorAll(
                'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
            );
            if (focusableElements.length === 0) return;

            const firstFocusableElement = focusableElements[0];
            const lastFocusableElement = focusableElements[focusableElements.length - 1];

            const handleFocusTrap = function (e) {
                if (e.key !== 'Tab') return;
                if (e.shiftKey) { // Shift + Tab
                    if (document.activeElement === firstFocusableElement) {
                        lastFocusableElement.focus();
                        e.preventDefault();
                    }
                } else { // Tab
                    if (document.activeElement === lastFocusableElement) {
                        firstFocusableElement.focus();
                        e.preventDefault();
                    }
                }
            };

            modalElement._handleFocusTrap = handleFocusTrap;
            modalElement.addEventListener('keydown', modalElement._handleFocusTrap);
            firstFocusableElement.focus();
        }

        function removeTrapFocus(modalElement) {
            if (modalElement && modalElement._handleFocusTrap) {
                modalElement.removeEventListener('keydown', modalElement._handleFocusTrap);
                delete modalElement._handleFocusTrap;
            }
        }


        function showMessageBox(message) {
            if (!messageBox || !messageText || !messageOkButton) return;

            lastFocusedElement = document.activeElement;
            messageText.textContent = message;
            messageBox.style.display = 'flex';

            trapFocus(messageBox);

            messageOkButton.onclick = () => {
                messageBox.style.display = 'none';
                removeTrapFocus(messageBox);
                if (lastFocusedElement) lastFocusedElement.focus();
            };
        }

        function showConfirmationModal(message, onConfirm) {
            if (!confirmationModal || !confirmationText || !confirmYesButton || !confirmNoButton) return;

            lastFocusedElement = document.activeElement;
            confirmationText.textContent = message;
            confirmationModal.style.display = 'flex';

            trapFocus(confirmationModal);
            if (confirmNoButton) confirmNoButton.focus(); // Default focus on "No" for safety

            const handleConfirmation = (result) => {
                confirmationModal.style.display = 'none';
                removeTrapFocus(confirmationModal);
                if (lastFocusedElement) lastFocusedElement.focus();
                onConfirm(result);
            };

            confirmYesButton.onclick = () => handleConfirmation(true);
            confirmNoButton.onclick = () => handleConfirmation(false);
        }

        // --- UI Interactions (Navigation, Dropdown, Announcement) ---

        // Mobile Navigation Toggle
        const navToggle = document.getElementById("nav-toggle");
        const navContent = document.getElementById("nav-content");

        if (navToggle && navContent) {
            navToggle.addEventListener("click", function () {
                const isOpen = navContent.classList.toggle("is-open");
                this.setAttribute('aria-expanded', isOpen ? 'true' : 'false');
                navContent.setAttribute('aria-hidden', isOpen ? 'false' : 'true');
            });

            // Close mobile menu when a link is clicked
            navContent.querySelectorAll('a').forEach(link => {
                link.addEventListener('click', () => {
                    // Check if it's a mobile view (less than 1024px)
                    if (window.innerWidth < 1024) {
                        navContent.classList.remove("is-open");
                        navToggle.setAttribute('aria-expanded', 'false');
                        navContent.setAttribute('aria-hidden', 'true');
                    }
                });
            });

            // Handle resize to ensure menu is always visible on desktop
            window.addEventListener('resize', () => {
                if (window.innerWidth >= 1024) {
                    navContent.classList.remove("is-open"); // Ensure closed class is removed
                    navToggle.setAttribute('aria-expanded', 'true');
                    navContent.setAttribute('aria-hidden', 'false');
                } else {
                    // If resized to mobile, ensure the menu honors its current state (closed by default)
                    if (navToggle.getAttribute('aria-expanded') === 'true') {
                        navContent.classList.add("is-open");
                    }
                }
            });
        }

        // Announcement Bar Close and Header Position Fix
        const closeAnnouncementBtn = document.getElementById("close-announcement");
        const announcementBar = document.getElementById("announcement-bar");
        const siteHeader = document.getElementById("site-header");
        if (closeAnnouncementBtn && announcementBar && siteHeader) {
            closeAnnouncementBtn.addEventListener("click", function () {
                announcementBar.style.display = "none";
                // Reset header position after closing announcement
                siteHeader.classList.add('fixed-top');
            });
        }


        // --- ADVANCED ACCESSIBILITY PANEL LOGIC ---

        const a11yPanel = document.getElementById('a11y-settings-panel');
        const a11yToggleButton = document.getElementById('a11y-toggle-button');
        const a11yCloseButton = document.getElementById('a11y-close-button');

        if (a11yPanel && a11yToggleButton && a11yCloseButton) {
            // Panel open/close
            a11yToggleButton.addEventListener('click', () => {
                a11yPanel.classList.add('a11y-panel-open');
                a11yPanel.setAttribute('aria-hidden', 'false');
                trapFocus(a11yPanel);
            });

            a11yCloseButton.addEventListener('click', () => {
                a11yPanel.classList.remove('a11y-panel-open');
                a11yPanel.setAttribute('aria-hidden', 'true');
                removeTrapFocus(a11yPanel);
                // Safely return focus to the toggle button
                if (a11yToggleButton) a11yToggleButton.focus();
            });

            // Close on escape key
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && a11yPanel.classList.contains('a11y-panel-open')) {
                    a11yPanel.classList.remove('a11y-panel-open');
                    a11yPanel.setAttribute('aria-hidden', 'true');
                    removeTrapFocus(a11yPanel);
                    // Safely return focus to the toggle button
                    if (a11yToggleButton) a11yToggleButton.focus();
                }
            });
        }


        // --- ACCESSIBILITY SETTINGS CONTROLS ---

        // Theme Buttons
        document.querySelectorAll('.theme-selector').forEach(button => {
            button.addEventListener('click', (e) => {
                const newTheme = e.currentTarget.dataset.theme;
                saveSettings({
                    ...currentSettings,
                    theme: newTheme
                });
            });
        });

        // Font Selection Logic
        const fontButtonsContainer = document.getElementById('font-selection-buttons');
        if (fontButtonsContainer) {
            fontButtonsContainer.querySelectorAll('.font-selector').forEach(button => {
                button.addEventListener('click', (e) => {
                    const newFont = e.currentTarget.dataset.font;
                    saveSettings({
                        ...currentSettings,
                        fontFamily: newFont
                    });
                });
            });
        }

        // --- Slider Handlers ---
        const sliderSettings = [{
            id: 'font-size',
            min: 0.8,
            max: 1.6,
            step: 0.1,
            factor: 100,
            unit: '%',
            cssVar: '--site-font-size',
            property: 'fontSize'
        }, {
            id: 'line-height',
            min: 1.3,
            max: 2.0,
            step: 0.1,
            factor: 1,
            unit: '',
            cssVar: '--site-line-height',
            property: 'lineHeight'
        }, {
            id: 'letter-spacing',
            min: -1,
            max: 3,
            step: 0.5,
            factor: 1,
            unit: 'px',
            cssVar: '--site-letter-spacing',
            property: 'letterSpacing'
        }, {
            id: 'word-spacing',
            min: 0,
            max: 5,
            step: 0.5,
            factor: 1,
            unit: 'px',
            cssVar: '--site-word-spacing',
            property: 'wordSpacing'
        },];

        sliderSettings.forEach(config => {
            const slider = document.getElementById(`${config.id}-slider`);
            const valueSpan = document.getElementById(`${config.id}-value`);

            if (slider && valueSpan) {
                // Initial setup
                const initialValue = currentSettings[config.property];
                slider.value = initialValue;
                valueSpan.textContent = (initialValue * config.factor).toFixed(config.unit === '%' ? 0 : 1);

                // Input (live update)
                slider.addEventListener('input', (e) => {
                    const value = parseFloat(e.target.value);
                    valueSpan.textContent = (value * config.factor).toFixed(config.unit === '%' ? 0 : 1);
                    document.documentElement.style.setProperty(config.cssVar, `${value}${config.unit === '%' ? 'rem' : config.unit}`);
                });

                // Change (save)
                slider.addEventListener('change', (e) => {
                    saveSettings({
                        ...currentSettings,
                        [config.property]: parseFloat(e.target.value)
                    });
                });
            }
        });

        // --- Toggle Handlers ---
        const toggleSettings = [{
            id: 'highlight-links',
            property: 'highlightLinks'
        }, {
            id: 'readable-width',
            property: 'readableWidth'
        }, {
            id: 'reduced-motion',
            property: 'reducedMotion'
        },];

        toggleSettings.forEach(config => {
            const toggle = document.getElementById(`toggle-${config.id}`);
            if (toggle) {
                // Initial setup
                toggle.checked = currentSettings[config.property];
                toggle.setAttribute('aria-checked', currentSettings[config.property]);

                // Change (save)
                toggle.addEventListener('change', (e) => {
                    e.target.setAttribute('aria-checked', e.target.checked);
                    saveSettings({
                        ...currentSettings,
                        [config.property]: e.target.checked
                    });
                });
            }
        });

        // Reset Button
        const resetA11yBtn = document.getElementById('reset-a11y-settings');
        if (resetA11yBtn) {
            resetA11yBtn.addEventListener('click', () => {
                // Use Confirmation Modal for a better UX than the original prompt
                showConfirmationModal("Are you sure you want to reset all display settings to the site defaults? This action cannot be undone.", (confirmed) => {
                    if (confirmed) {
                        localStorage.removeItem(STORAGE_KEY);
                        currentSettings = defaultSettings;
                        saveSettings({
                            ...defaultSettings
                        }); // Save and apply defaults

                        // Update all UI elements manually to reflect the reset state
                        sliderSettings.forEach(config => {
                            const slider = document.getElementById(`${config.id}-slider`);
                            const valueSpan = document.getElementById(`${config.id}-value`);
                            const defaultValue = defaultSettings[config.property];
                            if (slider) slider.value = defaultValue;
                            if (valueSpan) valueSpan.textContent = (defaultValue * config.factor).toFixed(config.unit === '%' ? 0 : 1);
                        });

                        updateFontButtonUI(defaultSettings.fontFamily);
                        updateThemeButtonUI(defaultSettings.theme);

                        toggleSettings.forEach(config => {
                            const toggle = document.getElementById(`toggle-${config.id}`);
                            const defaultValue = defaultSettings[config.property];
                            if (toggle) {
                                toggle.checked = defaultValue;
                                toggle.setAttribute('aria-checked', defaultValue);
                            }
                        });

                        showMessageBox("Settings have been reset to default values.");
                    }
                });
            });
        }
    </script>

</body>

</html>