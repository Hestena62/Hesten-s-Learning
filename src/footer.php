<!-- FULL FOOTER -->
<footer class="mt-auto bg-slate-900 text-slate-300 relative overflow-hidden font-sans border-t border-slate-800/50 w-full">
    <!-- Decoration -->
    <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 shadow-[0_0_20px_rgba(79,70,229,0.5)]"></div>
    <div class="absolute -top-[400px] -right-[400px] w-[800px] h-[800px] bg-blue-600/10 rounded-full blur-[100px] pointer-events-none overflow-hidden"></div>

    <div class="container mx-auto px-6 py-16 relative z-10">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-10">
            <!-- Column 1: About -->
            <div class="space-y-6">
                <h4 class="text-white font-bold text-lg mb-6 flex items-center gap-2 uppercase tracking-wide text-sm opacity-90">
                    <i class="fas fa-graduation-cap text-blue-500"></i> About
                </h4>
                <div class="flex items-center gap-3 group">
                    <div class="w-10 h-10 bg-gradient-to-br from-blue-600 to-purple-600 rounded-xl flex items-center justify-center shadow-lg shadow-blue-900/20 group-hover:rotate-6 transition-transform duration-300">
                        <span class="text-white font-bold text-xl font-serif">H</span>
                    </div>
                    <div class="flex flex-col">
                        <span class="text-lg font-bold text-white tracking-tight leading-none group-hover:text-blue-400 transition-colors">Hesten's Learning</span>
                        <span class="text-[10px] text-slate-500 uppercase tracking-widest font-semibold mt-1">Education for All</span>
                    </div>
                </div>
                <p class="text-slate-400 leading-relaxed text-sm">
                    Empowering students with learning disabilities through personalized learning experiences. <a href="#" class="text-blue-400 hover:text-blue-300 underline decoration-blue-500/30 hover:decoration-blue-300">Learn more</a>
                </p>
            </div>

            <!-- Column 2: Quick Links -->
            <div>
                <h4 class="text-white font-bold text-lg mb-6 flex items-center gap-2 uppercase tracking-wide text-sm opacity-90">
                    <i class="fas fa-link text-teal-500"></i> Quick Links
                </h4>
                <ul class="space-y-4 text-sm font-medium">
                    <li><a href="/curriculum.php" class="text-slate-400 hover:text-teal-400 transition-colors flex items-center gap-3 group"><i class="fas fa-book text-slate-600 group-hover:text-teal-500 transition-colors"></i> Curriculum</a></li>
                    <li><a href="/research" class="text-slate-400 hover:text-teal-400 transition-colors flex items-center gap-3 group"><i class="fas fa-flask text-slate-600 group-hover:text-teal-500 transition-colors"></i> Research</a></li>
                    <li><a href="/library" class="text-slate-400 hover:text-teal-400 transition-colors flex items-center gap-3 group"><i class="fas fa-book-open text-slate-600 group-hover:text-teal-500 transition-colors"></i> Library</a></li>
                    <li><a href="/help-center.php" class="text-slate-400 hover:text-teal-400 transition-colors flex items-center gap-3 group"><i class="fas fa-question-circle text-slate-600 group-hover:text-teal-500 transition-colors"></i> Help Center</a></li>
                </ul>
            </div>

            <!-- Column 3: Support -->
            <div>
                <h4 class="text-white font-bold text-lg mb-6 flex items-center gap-2 uppercase tracking-wide text-sm opacity-90">
                    <i class="fas fa-hand-holding-heart text-purple-500"></i> Support
                </h4>
                <ul class="space-y-4 text-sm font-medium">
                    <li><a href="/contact.php" class="text-slate-400 hover:text-purple-400 transition-colors flex items-center gap-3 group"><i class="fas fa-envelope text-slate-600 group-hover:text-purple-500 transition-colors"></i> Contact Us</a></li>
                    <li><a href="/students.php" class="text-slate-400 hover:text-purple-400 transition-colors flex items-center gap-3 group"><i class="fas fa-home text-slate-600 group-hover:text-purple-500 transition-colors"></i> For Students</a></li>
                    <li><a href="/parents.php" class="text-slate-400 hover:text-purple-400 transition-colors flex items-center gap-3 group"><i class="fas fa-users text-slate-600 group-hover:text-purple-500 transition-colors"></i> For Parents</a></li>
                    <li><a href="/teachers.php" class="text-slate-400 hover:text-purple-400 transition-colors flex items-center gap-3 group"><i class="fas fa-chalkboard-teacher text-slate-600 group-hover:text-purple-500 transition-colors"></i> For Teachers</a></li>
                </ul>
            </div>

            <!-- Column 4: Legal -->
            <div>
                <h4 class="text-white font-bold text-lg mb-6 flex items-center gap-2 uppercase tracking-wide text-sm opacity-90">
                    <i class="fas fa-balance-scale text-rose-500"></i> Legal & Settings
                </h4>
                <ul class="space-y-4 text-sm font-medium">
                    <li><a href="/privacy-policy.php" class="text-slate-400 hover:text-rose-400 transition-colors flex items-center gap-3 group"><i class="fas fa-shield-alt text-slate-600 group-hover:text-rose-500 transition-colors"></i> Privacy Policy</a></li>
                    <li><a href="/terms-of-use.php" class="text-slate-400 hover:text-rose-400 transition-colors flex items-center gap-3 group"><i class="fas fa-file-contract text-slate-600 group-hover:text-rose-500 transition-colors"></i> Terms of Use</a></li>
                    <li><a href="/settings.php" class="text-slate-400 hover:text-rose-400 transition-colors flex items-center gap-3 group"><i class="fas fa-universal-access text-slate-600 group-hover:text-rose-500 transition-colors"></i> Accessibility</a></li>
                    <li><a href="/about.php" class="text-slate-400 hover:text-rose-400 transition-colors flex items-center gap-3 group"><i class="fas fa-info-circle text-slate-600 group-hover:text-rose-500 transition-colors"></i> About Us</a></li>
                </ul>
            </div>
        </div>

        <div class="h-px bg-gradient-to-r from-transparent via-slate-700 to-transparent my-10"></div>

        <div class="flex flex-col md:flex-row justify-between items-center gap-6 text-sm text-slate-500">
            <div class="text-center md:text-left space-y-2">
                <p>
                    &copy; <span id="year">2025</span> <span class="text-slate-300 font-semibold">Hesten's Learning</span>. All rights reserved. |
                    Made with <i class="fas fa-heart text-red-500 animate-pulse mx-1"></i> for education
                </p>
                <p class="text-xs">
                    <a href="#" class="text-slate-400 hover:text-white transition-colors">Hesten's Learning</a> by
                    <a href="/about-me.php" class="text-slate-400 hover:text-white transition-colors">Hesten Allison</a> is licensed under
                    <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" class="inline-flex items-center gap-1 text-slate-400 hover:text-white transition-colors underline decoration-slate-600 hover:decoration-white underline-offset-2">
                        CC BY-NC-SA 4.0
                        <img style="height:16px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1" alt="">
                        <img style="height:16px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1" alt="">
                        <img style="height:16px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/nc.svg?ref=chooser-v1" alt="">
                        <img style="height:16px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1" alt="">
                    </a>
                </p>
            </div>

            <div class="flex flex-wrap justify-center items-center gap-6">
                <div class="gtranslate_wrapper"></div>
                <a href="https://www.buymeacoffee.com/hestena62l" target="_blank" rel="noopener noreferrer" class="group relative inline-flex items-center gap-2 bg-[#FFDD00] text-black px-5 py-2.5 rounded-full font-bold font-['Cookie',cursive] text-lg hover:bg-[#ffe44d] transition-all shadow-lg hover:shadow-[#FFDD00]/30 transform hover:-translate-y-1 font-handwriting">
                    <img src="https://cdn.buymeacoffee.com/buttons/bmc-new-btn-logo.svg" alt="" class="h-5 w-5" loading="lazy">
                    <span>Buy me a coffee</span>
                </a>
            </div>
        </div>
    </div>
</footer>

<!-- Global Modals -->
<div id="message-box" class="fixed inset-0 bg-black/75 backdrop-blur-sm hidden items-center justify-center z-[100]" role="alertdialog" aria-modal="true" aria-labelledby="message-title">
    <div class="bg-content-bg rounded-xl shadow-2xl p-6 max-w-sm w-full text-center border border-gray-200 dark:border-gray-700">
        <h4 id="message-title" class="text-xl font-bold mb-4 text-primary">Notification</h4>
        <p id="message-text" class="mb-6 text-text-default">Message content.</p>
        <button id="message-ok-button" class="bg-primary text-white px-6 py-2 rounded-lg font-semibold hover:bg-secondary" type="button">OK</button>
    </div>
</div>

<!-- GTranslate Config -->
<script>
    window.gtranslateSettings = {
        default_language: "en",
        native_language_names: true,
        wrapper_selector: ".gtranslate_wrapper",
        flag_style: "3d",
        alt_flags: {
            en: "usa"
        }
    };
</script>
<!-- Defer GTranslate to avoid blocking -->
<script src="https://cdn.gtranslate.net/widgets/latest/popup.js" defer></script>

<!-- GLOBAL SITE LOGIC ONLY -->
<script>
    // --- INIT GLOBAL ---
    window.addEventListener('load', () => {
        const loader = document.getElementById('initial-loader');
        if (loader) {
            loader.style.opacity = '0';
            setTimeout(() => loader.remove(), 500);
        }
    });

    document.addEventListener("DOMContentLoaded", () => {
        loadSettings();
        loadScratchpad();
        document.getElementById("year").textContent = new Date().getFullYear();

        // Mobile Nav
        document.getElementById("nav-toggle")?.addEventListener("click", () => {
            document.getElementById("nav-content").classList.toggle("hidden");
        });

        // A11y Focus
        setupPanelFocus('scratchpad-toggle', 'scratchpad-panel', 'scratchpad-close');
        setupPanelFocus('a11y-toggle-button', 'a11y-settings-panel', 'a11y-close-button');

        // Quick Notes Auto-save (Global Feature)
        document.getElementById('quick-notes-area')?.addEventListener('input', (e) => {
            localStorage.setItem('hl_scratchpad', e.target.value);
            const status = document.getElementById('scratchpad-status');
            status.textContent = "Saving...";
            setTimeout(() => status.textContent = "Saved", 1000);
        });
    });

    // --- UTILS ---
    function setupPanelFocus(triggerId, panelId, closeId) {
        const trigger = document.getElementById(triggerId);
        const panel = document.getElementById(panelId);
        const close = document.getElementById(closeId);

        if (!trigger || !panel) return;

        const toggle = () => {
            const isOpen = !panel.classList.contains('translate-x-full') && !panel.classList.contains('opacity-0');
            if (isOpen) {
                if (panelId.includes('settings')) panel.classList.add('translate-x-full');
                else {
                    panel.classList.add('opacity-0', 'pointer-events-none', 'scale-90');
                    panel.classList.remove('scale-100');
                }
                trigger.setAttribute('aria-expanded', 'false');
                trigger.focus();
            } else {
                if (panelId.includes('settings')) panel.classList.remove('translate-x-full');
                else {
                    panel.classList.remove('opacity-0', 'pointer-events-none', 'scale-90');
                    panel.classList.add('scale-100');
                }
                trigger.setAttribute('aria-expanded', 'true');
                setTimeout(() => close?.focus(), 100);
            }
        };
        trigger.onclick = toggle;
        if (close) close.onclick = toggle;
    }

    // Consolidated Confetti Logic (Safe Loading)
    function triggerConfetti(origin) {
        if (typeof confetti === 'function') {
            confetti({
                particleCount: 100,
                spread: 70,
                origin: origin || {
                    y: 0.6
                }
            });
        } else {
            // Check if script is already added
            if (!document.querySelector('script[src*="canvas-confetti"]')) {
                const script = document.createElement('script');
                script.src = '/src/canvas-confetti-1.9.4/package/dist/confetti.browser.js';
                script.onload = () => confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: origin || {
                        y: 0.6
                    }
                });
                document.body.appendChild(script);
            }
        }
    }

    function loadScratchpad() {
        try {
            const content = localStorage.getItem('hl_scratchpad');
            if (content && document.getElementById('quick-notes-area')) {
                document.getElementById('quick-notes-area').value = content;
            }
        } catch (e) {}
    }

    // --- MODALS ---
    const messageBox = document.getElementById("message-box");
    const messageText = document.getElementById("message-text");
    const messageOkButton = document.getElementById("message-ok-button");

    window.showMessageBox = function(message) {
        if (!messageBox || !messageText || !messageOkButton) return;
        messageText.textContent = message;
        messageBox.classList.remove("hidden");
        messageBox.style.display = 'flex';

        messageOkButton.onclick = () => {
            messageBox.classList.add("hidden");
            messageBox.style.display = 'none';
        };
    }

    // --- SETTINGS / ACCESSIBILITY ---
    const defaultSettings = {
        theme: 'light',
        fontSize: 1.0,
        lineHeight: 1.6,
        fontFamily: 'Inter',
        focusMode: false
    };
    const STORAGE_KEY = 'hl_accessibility_settings';
    let currentSettings = defaultSettings;

    function loadSettings() {
        try {
            const stored = localStorage.getItem(STORAGE_KEY);
            currentSettings = stored ? {
                ...defaultSettings,
                ...JSON.parse(stored)
            } : defaultSettings;
            applySettings(currentSettings);
            initSettingsUI();
        } catch (e) {}
    }

    function saveSettings(settings) {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));
        applySettings(settings);
        currentSettings = settings;
    }

    function applySettings(settings) {
        document.documentElement.style.setProperty('--site-font-size', `${settings.fontSize}rem`);
        document.documentElement.style.setProperty('--site-line-height', settings.lineHeight);
        let fontName = settings.fontFamily;
        if (fontName.includes(' ') || fontName === 'Open Dyslexic') fontName = `"${fontName}"`;
        document.documentElement.style.setProperty('--site-font-family', fontName);

        document.body.classList.remove('light', 'dark', 'high-contrast');
        document.body.classList.add(settings.theme);

        // Focus Mode
        if (settings.focusMode) document.body.classList.add('focus-mode');
        else document.body.classList.remove('focus-mode');
    }

    function initSettingsUI() {
        document.getElementById('theme-light')?.addEventListener('click', () => saveSettings({
            ...currentSettings,
            theme: 'light'
        }));
        document.getElementById('theme-dark')?.addEventListener('click', () => saveSettings({
            ...currentSettings,
            theme: 'dark'
        }));
        document.getElementById('theme-contrast')?.addEventListener('click', () => saveSettings({
            ...currentSettings,
            theme: 'high-contrast'
        }));

        const focusToggle = document.getElementById('toggle-focus-mode');
        if (focusToggle) {
            focusToggle.checked = currentSettings.focusMode;
            focusToggle.onchange = (e) => saveSettings({
                ...currentSettings,
                focusMode: e.target.checked
            });
        }

        document.querySelectorAll('.font-selector').forEach(btn => {
            btn.onclick = (e) => {
                const font = e.target.dataset.font;
                saveSettings({
                    ...currentSettings,
                    fontFamily: font
                });
                document.querySelectorAll('.font-selector').forEach(b => {
                    b.classList.remove('bg-primary', 'text-white');
                    if (b.dataset.font === font) b.classList.add('bg-primary', 'text-white');
                });
            };
        });

        const fontSlider = document.getElementById('font-size-slider');
        if (fontSlider) {
            fontSlider.value = currentSettings.fontSize;
            fontSlider.oninput = (e) => {
                document.getElementById('font-size-value').textContent = Math.round(e.target.value * 100);
                saveSettings({
                    ...currentSettings,
                    fontSize: e.target.value
                });
            };
        }
    }

    // Optimized Scroll To Top
    const scrollBtn = document.getElementById("scroll-to-top");
    if (scrollBtn) {
        let lastScrollY = window.scrollY;
        let ticking = false;

        window.addEventListener("scroll", () => {
            lastScrollY = window.scrollY;
            if (!ticking) {
                window.requestAnimationFrame(() => {
                    if (lastScrollY > 300) scrollBtn.classList.remove("translate-y-24", "opacity-0");
                    else scrollBtn.classList.add("translate-y-24", "opacity-0");
                    ticking = false;
                });
                ticking = true;
            }
        }, {
            passive: true
        });
        scrollBtn.onclick = () => window.scrollTo({
            top: 0,
            behavior: "smooth"
        });
    }
</script>
</body>

</html>